
## Towards Spatially-Lucid AI Classification in Non-Euclidean Space: An Application for MxIF Oncology Data
Given multi-category point sets (e.g., cellular spatial maps) from different place-types (e.g., tumor regions), our goal is to develop a spatially-lucid classifier that can distinguish between two classes based on the arrangements of their points. This problem is important for many applications, such as oncology, for analyzing immune-tumor relationships and designing new immunotherapies. It is challenging due to spatial variability and spatial interpretability needs. Previously proposed techniques (e.g., spatial variability-aware neural networks (SVANN)) require dense training data or have limited ability to handle significant spatial variability within a single place-type. Most importantly, these deep neural network (DNN) approaches are not designed to work in non-Euclidean space, particularly point sets (e.g., point cloud and cellular spatial maps). Existing non-Euclidean DNN methods are limited to one-size-fits-all approaches. We explore a spatial ensemble framework that explicitly uses different training strategies (e.g., weighted-distance learning rate and spatial domain adaptation) on various place-types for spatially-lucid classification. Experimental results on real-world datasets (e.g., MxIF oncology data) show that the proposed framework provides higher prediction accuracy than baseline methods.
## Model architecture
This framework deploys a spatial ensemble technique involving multiple spatial models via a tailored point-wise convolution to capture relationships among different place-types, where each neural network weight is a map weight that varies across spatial domains. This entails aggregating individual model predictions through a function (e.g., weighted average, majority vote), considering the variability in spatial patterns within each distinct place-type. For example, with a distance threshold $\alpha=1$, each place-type has a separate deep neural network (DNN) trained on respective multi-category point sets. Predictions are then aggregated to determine the class label across the entire spatial domain. However, sufficient learning samples may not be available to train separate DNN classifiers. To address this, we explore alternative training strategies like weighted-distance learning rates and spatial domain adaptation, where all samples can train the target classifier (Sections \ref{wdlr}, \ref{sda}).

In this problem, we are given multi-category point sets from various place-types, where each point set is associated with one of two class labels. Additionally, we have a weighted distance matrix, denoted as $D$, where each cell represents the relative distance between two place-types $T_i$ and $T_j$, as defined by domain experts. The objective is to develop a spatially-lucid classifier algorithm that accurately separates the two class labels. Since each place-type belongs to a unique spatial domain, the location of the target deep neural network classifier is significant. This positioning is essential for selecting suitable training samples, which is determined by the distance threshold $\alpha$. It allows the model to learn spatial patterns specific to each place-type, ensuring it accommodates spatial variations and yields dependable classification results.
<img src='./Proposed.jpg' width=1200>

## Acknowledgement
The structure of this codebase is borrowed from [DGCNN](https://github.com/WangYueFt/dgcnn) and [SAMCNet](https://github.com/majid-farhadloo/SAMCNet_2022)
